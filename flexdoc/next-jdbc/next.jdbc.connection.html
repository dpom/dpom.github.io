<!DOCTYPE html PUBLIC "" "">
<html>
<head>
  <meta charset="UTF-8" />
  <title>next-jdbc</title>
  <link rel="stylesheet" type="text/css" href="https://dpom.github.io/flexdoc/css/default.css" />
  <link rel="stylesheet" type="text/css" href="https://dpom.github.io/flexdoc/css/highlight.css" />
  <script type="text/javascript" src="https://dpom.github.io/flexdoc/js/highlight.min.js"></script>
  <script type="text/javascript" src="https://dpom.github.io/flexdoc/js/jquery.min.js"></script>
  <script type="text/javascript" src="https://dpom.github.io/flexdoc/js/page_effects.js"></script>
  <script>
    hljs.initHighlightingOnLoad();
  </script>
</head>
<body>
  <div id="header">
    <h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2>
    <h1><a href="https://dpom.github.io/flexdoc/next-jdbc/index.html">
        <span class="project-title">
          <span class="project-name">next-jdbc</span>
          <span class="project-version"></span>
        </span>
      </a>
    </h1>
  </div>
  <div id="sidebar1" class="sidebar primary">
  <h3 class="no-link">
    <span class="inner">Project</span>
  </h3>
  <ul class="index-link">
     <li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>next</span></div></div></li><li class="depth-2"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jdbc</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>connection</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.datafy.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>datafy</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.date-time.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>date-time</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.optional.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>optional</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.plan.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plan</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.prepare.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>prepare</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.protocols.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>protocols</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.quoted.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>quoted</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.result-set.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>result-set</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.specs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>specs</span></div></a></li><li class="depth-3"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.sql.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>sql</span></div></a></li><li class="depth-4"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.sql.builder.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>builder</span></div></a></li><li class="depth-3 branch"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.transaction.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>transaction</span></div></a></li><li class="depth-3"><a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.types.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>types</span></div></a></li> 
  </ul>
  </div>
  
<div id="sidebar2" class="sidebar secondary">
  <h3>
    <a href="#top">
      <span class="inner">Public Vars</span>
    </a>
  </h3>
  <ul id="pubvarmenu">
    
    <li id="pubvaritem" class="depth-1">
      <a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection/-&gt;pool.html">
        <span>-&gt;pool</span>
      </a>
    </li>
    
    <li id="pubvaritem" class="depth-1">
      <a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection/component.html">
        <span>component</span>
      </a>
    </li>
    
    <li id="pubvaritem" class="depth-1">
      <a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection/dbtypes.html">
        <span>dbtypes</span>
      </a>
    </li>
    
    <li id="pubvaritem" class="depth-1">
      <a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection/jdbc-url.html">
        <span>jdbc-url</span>
      </a>
    </li>
    
    <li id="pubvaritem" class="depth-1">
      <a href="https://dpom.github.io/flexdoc/next-jdbc/next.jdbc.connection/uri-&gt;db-spec.html">
        <span>uri-&gt;db-spec</span>
      </a>
    </li>
    
  </ul>
</div>

<div id="content" class="namespaces-docs">
  <table id="pubvar-list">
    <tr>
      <th>Public Var</th>
      <th>Description</th>
    </tr>
    
    <tr class="pubvar-item">
      <td class="pubvar-name">-&gt;pool</td>
      <td class="pubvar-doc">Given a (connection pooled datasource) class and a database spec, return a
connection pool object built from that class and the database spec.

Assumes the `clazz` has a `.setJdbcUrl` method (which HikariCP and c3p0 do).

If you already have a JDBC URL and want to use this method, pass `:jdbcUrl`
in the database spec (instead of `:dbtype`, `:dbname`, etc).

Properties for the connection pool object can be passed as mixed case
keywords that correspond to setter methods (just as `:jdbcUrl` maps to
`.setJdbcUrl`). `clojure.java.data/to-java` is used to construct the
object and call the setters.

Note that the result is not type-hinted (because there&#39;s no common base
class or interface that can be assumed). In particular, connection pooled
datasource objects may need to be closed but they don&#39;t necessarily implement
`java.io.Closeable` (HikariCP does, c3p0 does not).</td>
    </tr>
    
    <tr class="pubvar-item">
      <td class="pubvar-name">component</td>
      <td class="pubvar-doc">Takes the same arguments as `-&gt;pool` but returns an entity compatible
with Stuart Sierra&#39;s Component: when `com.stuartsierra.component/start`
is called on it, it builds a connection pooled datasource, and returns
an entity that can either be invoked as a function with no arguments
to return that datasource, or can have `com.stuartsierra.component/stop`
called on it to shutdown the datasource (and return a new startable
entity).

If `db-spec` contains `:init-fn`, that is assumed to be a function
that should be called on the newly-created datasource. This allows for
modification of (mutable) connection pooled datasource and/or some sort
of database initialization/setup to be called automatically.

By default, the datasource is shutdown by calling `.close` on it.
If the datasource class implements `java.io.Closeable` then a direct,
type-hinted call to `.close` will be used, with no reflection,
otherwise Java reflection will be used to find the first `.close`
method in the datasource class that takes no arguments and returns `void`.

If neither of those behaviors is appropriate, you may supply a third
argument to this function -- `close-fn` -- which performs whatever
action is appropriate to your chosen datasource class.</td>
    </tr>
    
    <tr class="pubvar-item">
      <td class="pubvar-name">dbtypes</td>
      <td class="pubvar-doc">A map of all known database types (including aliases) to the class name(s)
and port that `next.jdbc` supports out of the box. For databases that have
non-standard prefixes for the `:dbname` and/or `:host` values in the JDBC
string, this table includes `:dbname-separator` and/or `:host-prefix`. The
default prefix for `:dbname` is either `/` or `:` and for `:host` it is `//`.
For local databases, with no `:host`/`:port` segment in their JDBC URL, a
value of `:none` is provided for `:host` in this table. In addition,
`:property-separator` can specify how you build the JDBC URL.

For known database types, you can use `:dbtype` (and omit `:classname`).

If you want to use a database that is not in this list, you can specify
a new `:dbtype` along with the class name of the JDBC driver in `:classname`.
You will also need to specify `:port`. For example:

   `{:dbtype &quot;acme&quot; :classname &quot;com.acme.JdbcDriver&quot; ...}`

The value of `:dbtype` should be the string that the driver is associated
with in the JDBC URL, i.e., the value that comes between the `jdbc:`
prefix and the `://&lt;host&gt;...` part. In the above example, the JDBC URL
that would be generated would be `jdbc:acme://&lt;host&gt;:&lt;port&gt;/&lt;dbname&gt;`.

If you want `next.jdbc` to omit the host/port part of the URL, specify
`:host :none`, which would produce a URL like: `jdbc:acme:&lt;dbname&gt;`,
which allows you to work with local databases (or drivers that do not
need host/port information).

The default prefix for the host name (or IP address) is `//`. You
can override this via the `:host-prefix` option.

The default separator between the host/port and the database name is `/`.
The default separator between the subprotocol and the database name,
for local databases with no host/port, is `:`. You can override this
via the `:dbname-separator` option.

JDBC drivers are not provided by `next.jdbc` -- you need to specify the
driver(s) you need as additional dependencies in your project. For
example:

   `[com.acme/jdbc &quot;1.2.3&quot;] ; lein/boot`

or:

   `com.acme/jdbc {:mvn/version &quot;1.2.3&quot;} ; CLI/deps.edn`

Note: the `:classname` value can be a string or a vector of strings. If
a vector of strings is provided, an attempt will be made to load each
named class in order, until one succeeds. This allows for a given `:dbtype`
to be used with different versions of a JDBC driver, if the class name
has changed over time (such as with MySQL).</td>
    </tr>
    
    <tr class="pubvar-item">
      <td class="pubvar-name">jdbc-url</td>
      <td class="pubvar-doc">Given a database spec (as a hash map), return a JDBC URL with all the
  attributes added to the query string. The result is suitable for use in
  calls to `-&gt;pool` and `component` as the `:jdbcUrl` key in the parameter
  map for the connection pooling library.

  This allows you to build a connection-pooled datasource that needs
  additional settings that the pooling library does not support, such as
  `:serverTimezone`:

```clojure
  (def db-spec {:dbtype .. :dbname .. :user .. :password ..
                :serverTimezone &quot;UTC&quot;})
  (def ds (next.jdbc.connection/-&gt;pool
           HikariCP {:jdbcUrl (next.jdbc.connection/jdbc-url db-spec)
                     :maximumPoolSize 15}))
```

  This also clearly separates the attributes that should be part of the
  JDBC URL from the attributes that should be configured on the pool.

  Since JDBC drivers can handle URL encoding differently, if you are
  trying to pass attributes that might need encoding, you should make
  sure they are properly URL-encoded as values in the database spec hash map.
  This function does **not** attempt to URL-encode values for you!</td>
    </tr>
    
    <tr class="pubvar-item">
      <td class="pubvar-name">uri-&gt;db-spec</td>
      <td class="pubvar-doc">clojure.java.jdbc (and some users out there) considered the URI format
to be an acceptable JDBC URL, i.e., with credentials embdedded in the string,
rather than as query parameters.

This function accepts a URI string, optionally prefixed with `jdbc:` and
returns a db-spec hash map.</td>
    </tr>
    
  </table>

</div>

</body>
